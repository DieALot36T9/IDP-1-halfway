# --- DATABASE CONNECTION CONFIGURATION ---
# IMPORTANT: Replace these placeholders with your actual Oracle DB credentials.
# For security, it's better to use environment variables in a real application.
DB_USER = os.environ.get("DB_USER", "EBOOK_SITE")
DB_PASSWORD = os.environ.get("DB_PASSWORD", "1124")
# Example DSN for Oracle XE: "localhost:1521/XEPDB1"
DB_DSN = os.environ.get("DB_DSN", "localhost:1521/XEPDB1")

database user
CREATE USER ebook_site IDENTIFIED BY 1124;

GRANT CONNECT, RESOURCE, DBA TO ebook_site;
GRANT CREATE SESSION TO ebook_site;
GRANT UNLIMITED TABLESPACE TO ebook_site;


Table structure
### 1\. Users Table

Stores information for readers.

```sql
CREATE TABLE users (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR2(100) NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    phone VARCHAR2(20),
    password VARCHAR2(100) NOT NULL,
    subscription_end_date DATE,
    session_token VARCHAR2(255) UNIQUE,
    token_expiry TIMESTAMP
);
```

-----

### 2\. Publishers Table

Stores information for publishers.

```sql
CREATE TABLE publishers (
    publisher_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR2(100) NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    phone VARCHAR2(20),
    address VARCHAR2(255),
    description VARCHAR2(1000),
    image_path VARCHAR2(255),
    password VARCHAR2(100) NOT NULL,
    session_token VARCHAR2(255) UNIQUE,
    token_expiry TIMESTAMP
);
```

-----

### 3\. Books Table

Contains all the book details and links them to a publisher.

```sql
CREATE TABLE books (
    book_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR2(255) NOT NULL,
    author_name VARCHAR2(100),
    description VARCHAR2(2000),
    category VARCHAR2(50),
    cover_path VARCHAR2(255),
    pdf_path VARCHAR2(255) NOT NULL,
    publisher_id NUMBER,
    CONSTRAINT fk_publisher
        FOREIGN KEY(publisher_id)
        REFERENCES publishers(publisher_id)
        ON DELETE CASCADE
);
```

-----

### 4\. Bookmarks Table

Links users to the books they have bookmarked.

```sql
CREATE TABLE bookmarks (
    user_id NUMBER,
    book_id NUMBER,
    PRIMARY KEY (user_id, book_id),
    FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,
    FOREIGN KEY(book_id) REFERENCES books(book_id) ON DELETE CASCADE
);
```

-----

### 5\. Reading History Table

Tracks the books a user has recently read.

```sql
CREATE TABLE reading_history (
    history_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id NUMBER,
    book_id NUMBER,
    last_read_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE (user_id, book_id),
    FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,
    FOREIGN KEY(book_id) REFERENCES books(book_id) ON DELETE CASCADE
);
```
